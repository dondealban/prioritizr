<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add locked in constraints — add_locked_in_constraints • prioritizr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Add locked in constraints — add_locked_in_constraints" />
<meta property="og:description" content="Add constraints to a conservation planning problem to ensure
that specific planning units are selected (or allocated
to a specific zone) in the solution. For example, it may be desirable to
lock in planning units that are inside existing protected areas so that the
solution fills in the gaps in the existing reserve network. If specific
planning units should be locked out of a solution, use
add_locked_out_constraints. For problems with non-binary
planning unit allocations (e.g. proportions), the
add_manual_locked_constraints function can be used to lock
planning unit allocations to a specific value." />
<meta property="og:image" content="https://prioritizr.net/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/saltspring.html">Salt Spring Island Tutorial</a>
    </li>
    <li>
      <a href="../articles/tasmania.html">Tasmania Tutorial</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add locked in constraints</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_locked_in_constraints.R'><code>R/add_locked_in_constraints.R</code></a></small>
    <div class="hidden name"><code>add_locked_in_constraints.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add constraints to a conservation planning <code><a href='problem.html'>problem</a></code> to ensure
that specific planning units are selected (or allocated
to a specific zone) in the solution. For example, it may be desirable to
lock in planning units that are inside existing protected areas so that the
solution fills in the gaps in the existing reserve network. If specific
planning units should be locked out of a solution, use
<code><a href='add_locked_out_constraints.html'>add_locked_out_constraints</a></code>. For problems with non-binary
planning unit allocations (e.g. proportions), the
<code><a href='add_manual_locked_constraints.html'>add_manual_locked_constraints</a></code> function can be used to lock
planning unit allocations to a specific value.</p>
    </div>

    <pre class="usage"><span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)

<span class='co'># S4 method for ConservationProblem,numeric</span>
<span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)

<span class='co'># S4 method for ConservationProblem,logical</span>
<span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)

<span class='co'># S4 method for ConservationProblem,matrix</span>
<span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)

<span class='co'># S4 method for ConservationProblem,character</span>
<span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)

<span class='co'># S4 method for ConservationProblem,Spatial</span>
<span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)

<span class='co'># S4 method for ConservationProblem,Raster</span>
<span class='fu'>add_locked_in_constraints</span>(<span class='no'>x</span>, <span class='no'>locked_in</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>locked_in</th>
      <td><p>Object that determines which planning units that should be
locked in. See the Details section for more information.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the constraints
  added to it.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The locked planning units can be specified in several different
  ways. Generally, the locked data should correspond to the planning units
  in the argument to <code>x.</code> To help make working with
  <code>Raster-class</code> planning unit data easier,
  the locked data should correspond to cell indices in the
  <code>Raster-class</code> data. For example, <code>integer</code> arguments
  should correspond to cell indices and <code>logical</code> arguments should have
  a value for each cell---regardless of which planning unit cells contain
  <code>NA</code> values.</p>
<p></p><dl class='dl-horizontal'>
    <dt><code>integer</code></dt><dd><p><code>vector</code> of indices pertaining to which
    planning units should be locked in the solution. This argument is only
    compatible with problems that contain a single zone.</p></dd>
    <dt><code>logical</code></dt><dd><p><code>vector</code> containing <code>TRUE</code> and/or
    <code>FALSE</code> values that indicate which planning units should be locked
    in the solution. This argument is only compatible with problems that
    contain a single zone.</p></dd>
    <dt><code>matrix</code></dt><dd><p>containing <code>logical</code> <code>TRUE</code> and/or
    <code>FALSE</code> values which indicate if certain planning units are
    should be locked to a specific zone in the solution. Each row
    corresponds to a planning unit, each column corresponds to a zone, and
    each cell indicates if the planning unit should be locked to a given
    zone. Thus each row should only contain at most a single <code>TRUE</code>
    value.</p></dd>
    <dt><code>character</code></dt><dd><p>field (column) name(s) that indicate if planning
    units should be locked in the solution. This type of argument is only
    compatible if the planning units in the argument to <code>x</code> are a
    <code><a href='https://www.rdocumentation.org/packages/sp/topics/Spatial-class'>Spatial-class</a></code> or <code>data.frame</code> object. The fields
    (columns) must have <code>logical</code>  (i.e. <code>TRUE</code> or <code>FALSE</code>)
    values indicating if the planning unit is to be locked in the solution.
    For problems containing multiple zones, this argument should contain
    a field (column) name for each management zone.</p></dd>
    <dt><code><a href='https://www.rdocumentation.org/packages/raster/topics/Raster-classes'>Raster-class</a></code></dt><dd><p>planning units in <code>x</code>
    that intersect with non-zero and non-<code>NA</code> raster cells are locked
    in the solution. For problems that contain multiple zones, the
    <code><a href='https://www.rdocumentation.org/packages/raster/topics/Raster-classes'>Raster-class</a></code> object must contain a layer
    for each zone. Note that for multi-band arguments, each pixel must
    only contain a non-zero value in a single band. Additionally, if the
    cost data in <code>x</code> is a <code><a href='https://www.rdocumentation.org/packages/raster/topics/Raster-classes'>Raster-class</a></code> object, we
    recommend standardizing <code>NA</code> values in this dataset with the cost
    data. In other words, the pixels in <code>x</code> that have <code>NA</code> values
    should also have <code>NA</code> values in the locked data.</p></dd>
  </dl>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='constraints.html'>constraints</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set seed for reproducibility</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>500</span>)

<span class='co'># load data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_features</span>, <span class='no'>sim_locked_in_raster</span>)

<span class='co'># create minimal problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_features</span>, <span class='st'>"cost"</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fl'>0.2</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>()

<span class='co'># create problem with added locked in constraints using integers</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/which'>which</a></span>(<span class='no'>sim_pu_polygons</span>$<span class='no'>locked_in</span>))

<span class='co'># create problem with added locked in constraints using a field name</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='st'>"locked_in"</span>)

<span class='co'># create problem with added locked in constraints using raster data</span>
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='no'>sim_locked_in_raster</span>)

<span class='co'># create problem with added locked in constraints using spatial polygon data</span>
<span class='no'>locked_in</span> <span class='kw'>&lt;-</span> <span class='no'>sim_pu_polygons</span>[<span class='no'>sim_pu_polygons</span>$<span class='no'>locked_in</span> <span class='kw'>==</span> <span class='fl'>1</span>, ]
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='no'>locked_in</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p1</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 3934.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.496032e+03, 16 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3496.03193    0    4 3934.62184 3496.03193  11.1%     -    0s
#&gt; H    0     0                    3585.9601335 3496.03193  2.51%     -    0s
#&gt; 
#&gt; Explored 1 nodes (16 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3585.96 3934.62 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.585960133519e+03, best bound 3.496031931890e+03, gap 2.5078%</div><div class='input'><span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p2</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 4017.6427161
#&gt; Presolve removed 0 rows and 10 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; Variable types: 0 continuous, 80 integer (80 binary)
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.610717e+03, 15 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3610.71743    0    4 4017.64272 3610.71743  10.1%     -    0s
#&gt; H    0     0                    3649.3763088 3610.71743  1.06%     -    0s
#&gt; 
#&gt; Explored 1 nodes (15 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3649.38 4017.64 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.649376308848e+03, best bound 3.610717428789e+03, gap 1.0593%</div><div class='input'><span class='no'>s3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p3</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 4017.6427161
#&gt; Presolve removed 0 rows and 10 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; Variable types: 0 continuous, 80 integer (80 binary)
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.610717e+03, 15 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3610.71743    0    4 4017.64272 3610.71743  10.1%     -    0s
#&gt; H    0     0                    3649.3763088 3610.71743  1.06%     -    0s
#&gt; 
#&gt; Explored 1 nodes (15 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3649.38 4017.64 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.649376308848e+03, best bound 3.610717428789e+03, gap 1.0593%</div><div class='input'><span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p4</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 4017.6427161
#&gt; Presolve removed 0 rows and 10 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; Variable types: 0 continuous, 80 integer (80 binary)
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.610717e+03, 15 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3610.71743    0    4 4017.64272 3610.71743  10.1%     -    0s
#&gt; H    0     0                    3649.3763088 3610.71743  1.06%     -    0s
#&gt; 
#&gt; Explored 1 nodes (15 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3649.38 4017.64 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.649376308848e+03, best bound 3.610717428789e+03, gap 1.0593%</div><div class='input'><span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p5</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 4017.6427161
#&gt; Presolve removed 0 rows and 10 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; Variable types: 0 continuous, 80 integer (80 binary)
#&gt; Presolved: 5 rows, 80 columns, 400 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.610717e+03, 15 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3610.71743    0    4 4017.64272 3610.71743  10.1%     -    0s
#&gt; H    0     0                    3649.3763088 3610.71743  1.06%     -    0s
#&gt; 
#&gt; Explored 1 nodes (15 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3649.38 4017.64 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.649376308848e+03, best bound 3.610717428789e+03, gap 1.0593%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>2</span>), <span class='kw'>mar</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>4.1</span>, <span class='fl'>0</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s1</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"none locked in"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s1</span>[<span class='no'>s1</span>$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s2</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"locked in (integer input)"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s2</span>[<span class='no'>s2</span>$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s3</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"locked in (character input)"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s3</span>[<span class='no'>s3</span>$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s4</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"locked in (raster input)"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s4</span>[<span class='no'>s4</span>$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s5</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"locked in (polygon input)"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s5</span>[<span class='no'>s5</span>$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='img'><img src='add_locked_in_constraints-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create minimal multi-zone problem with spatial data</span>
<span class='no'>p6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_polygons</span>, <span class='no'>sim_features_zones</span>,
              <span class='kw'>cost_column</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"cost_1"</span>, <span class='st'>"cost_2"</span>, <span class='st'>"cost_3"</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_absolute_targets.html'>add_absolute_targets</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Poisson'>rpois</a></span>(<span class='fl'>15</span>, <span class='fl'>1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>,
                                  <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>()

<span class='co'># create multi-zone problem with locked in constraints using matrix data</span>
<span class='no'>locked_matrix</span> <span class='kw'>&lt;-</span> <span class='no'>sim_pu_zones_polygons</span>@<span class='kw'>data</span>[, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"locked_1"</span>, <span class='st'>"locked_2"</span>,
                                                <span class='st'>"locked_3"</span>)]
<span class='no'>locked_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='no'>locked_matrix</span>)

<span class='no'>p7</span> <span class='kw'>&lt;-</span> <span class='no'>p6</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='no'>locked_matrix</span>)</div><div class='input'><span class='co'># solve problem</span>
<span class='no'>s6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p6</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 3e+00]
#&gt; Found heuristic solution: objective 3524.7950998
#&gt; Presolve removed 7 rows and 0 columns
#&gt; Presolve time: 0.02s
#&gt; Presolved: 98 rows, 270 columns, 990 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 98 rows, 270 columns, 990 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.642776e+03, 9 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2642.77567    0    5 3524.79510 2642.77567  25.0%     -    0s
#&gt; H    0     0                    2875.8073247 2642.77567  8.10%     -    0s
#&gt; 
#&gt; Explored 1 nodes (9 simplex iterations) in 0.03 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 2875.81 3524.8 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.875807324677e+03, best bound 2.642775673413e+03, gap 8.1032%</div><div class='input'>
<span class='co'># create new column representing the zone id that each planning unit</span>
<span class='co'># was allocated to in the solution</span>
<span class='no'>s6</span>$<span class='no'>solution</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='category_vector.html'>category_vector</a></span>(<span class='no'>s6</span>@<span class='kw'>data</span>[, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"solution_1_zone_1"</span>,
                                           <span class='st'>"solution_1_zone_2"</span>,
                                           <span class='st'>"solution_1_zone_3"</span>)])
<span class='no'>s6</span>$<span class='no'>solution</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='no'>s6</span>$<span class='no'>solution</span>)

<span class='co'># plot solution</span>
<span class='fu'>spplot</span>(<span class='no'>s6</span>, <span class='kw'>zcol</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_locked_in_constraints-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create multi-zone problem with locked in constraints using field names</span>
<span class='no'>p8</span> <span class='kw'>&lt;-</span> <span class='no'>p6</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"locked_1"</span>, <span class='st'>"locked_2"</span>, <span class='st'>"locked_3"</span>))</div><div class='input'><span class='co'># solve problem</span>
<span class='no'>s8</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p8</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 3e+00]
#&gt; Found heuristic solution: objective 3335.9942703
#&gt; Presolve removed 27 rows and 118 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 78 rows, 152 columns, 304 nonzeros
#&gt; Variable types: 0 continuous, 152 integer (152 binary)
#&gt; Presolved: 78 rows, 152 columns, 304 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.324542e+03, 2 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt; *    0     0               0    3324.5423913 3324.54239  0.00%     -    0s
#&gt; 
#&gt; Explored 0 nodes (2 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3324.54 3335.99 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.324542391321e+03, best bound 3.324542391321e+03, gap 0.0000%</div><div class='input'>
<span class='co'># create new column representing the zone id that each planning unit</span>
<span class='co'># was allocated to in the solution</span>
<span class='no'>s8</span>$<span class='no'>solution</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='category_vector.html'>category_vector</a></span>(<span class='no'>s8</span>@<span class='kw'>data</span>[, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"solution_1_zone_1"</span>,
                                           <span class='st'>"solution_1_zone_2"</span>,
                                           <span class='st'>"solution_1_zone_3"</span>)])
<span class='no'>s8</span>$<span class='no'>solution</span>[<span class='no'>s8</span>$<span class='no'>solution</span> <span class='kw'>==</span> <span class='fl'>1</span> <span class='kw'>&amp;</span> <span class='no'>s8</span>$<span class='no'>solution_1_zone_1</span> <span class='kw'>==</span> <span class='fl'>0</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>s8</span>$<span class='no'>solution</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='no'>s8</span>$<span class='no'>solution</span>)

<span class='co'># plot solution</span>
<span class='fu'>spplot</span>(<span class='no'>s8</span>, <span class='kw'>zcol</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_locked_in_constraints-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create multi-zone problem with raster planning units</span>
<span class='no'>p9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_absolute_targets.html'>add_absolute_targets</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Poisson'>rpois</a></span>(<span class='fl'>15</span>, <span class='fl'>1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>()

<span class='co'># create raster stack with locked in units</span>
<span class='no'>locked_in_stack</span> <span class='kw'>&lt;-</span> <span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]
<span class='no'>locked_in_stack</span>[!<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/NA'>is.na</a></span>(<span class='no'>locked_in_stack</span>)] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>locked_in_stack</span> <span class='kw'>&lt;-</span> <span class='no'>locked_in_stack</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>)]]
<span class='no'>locked_in_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]][<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>locked_in_stack</span><span class='kw'>[[</span><span class='fl'>2</span>]][<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>locked_in_stack</span><span class='kw'>[[</span><span class='fl'>3</span>]][<span class='fl'>3</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='co'># plot locked in stack</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>locked_in_stack</span>)</div><div class='img'><img src='add_locked_in_constraints-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># add locked in raster units to problem</span>
<span class='no'>p9</span> <span class='kw'>&lt;-</span> <span class='no'>p9</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_locked_in_constraints</span>(<span class='no'>locked_in_stack</span>)</div><div class='input'><span class='co'># solve problem</span>
<span class='no'>s9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p9</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+00]
#&gt; Found heuristic solution: objective 2881.4469505
#&gt; Presolve removed 12 rows and 9 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 93 rows, 261 columns, 783 nonzeros
#&gt; Variable types: 0 continuous, 261 integer (261 binary)
#&gt; Presolved: 93 rows, 261 columns, 783 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.289262e+03, 12 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2289.26159    0    6 2881.44695 2289.26159  20.6%     -    0s
#&gt; H    0     0                    2666.3302066 2289.26159  14.1%     -    0s
#&gt; H    0     0                    2463.5687146 2289.26159  7.08%     -    0s
#&gt; 
#&gt; Explored 1 nodes (12 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 2463.57 2666.33 2881.45 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.463568714567e+03, best bound 2.289261594758e+03, gap 7.0754%</div><div class='input'>
<span class='co'># plot solution</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='no'>s9</span>), <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_locked_in_constraints-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='https://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com'>Joseph Bennett</a>, <a href='http://www.possinghamlab.org'>Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>


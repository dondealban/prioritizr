<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add maximum phylogenetic diversity objective — add_max_phylo_div_objective • prioritizr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Add maximum phylogenetic diversity objective — add_max_phylo_div_objective" />
<meta property="og:description" content="Set the objective of a conservation planning problem to
maximize the phylogenetic diversity of the features represented in the
solution subject to a budget. This objective is similar to
add_max_features_objective except
that emphasis is placed on representing a phylogenetically diverse set of
species, rather than as many features as possible (subject to weights).
This function was inspired by Faith (1992) and Rodrigues et al.
(2002)." />
<meta property="og:image" content="https://prioritizr.net/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/saltspring.html">Salt Spring Island Tutorial</a>
    </li>
    <li>
      <a href="../articles/tasmania.html">Tasmania Tutorial</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add maximum phylogenetic diversity objective</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_max_phylo_div_objective.R'><code>R/add_max_phylo_div_objective.R</code></a></small>
    <div class="hidden name"><code>add_max_phylo_div_objective.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Set the objective of a conservation planning <code><a href='problem.html'>problem</a></code> to
maximize the phylogenetic diversity of the features represented in the
solution subject to a budget. This objective is similar to
<code><a href='add_max_features_objective.html'>add_max_features_objective</a></code> except
that emphasis is placed on representing a phylogenetically diverse set of
species, rather than as many features as possible (subject to weights).
This function was inspired by Faith (1992) and Rodrigues <em>et al.</em>
(2002).</p>
    </div>

    <pre class="usage"><span class='fu'>add_max_phylo_div_objective</span>(<span class='no'>x</span>, <span class='no'>budget</span>, <span class='no'>tree</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>budget</th>
      <td><p><code>numeric</code> value specifying the maximum expenditure of
the prioritization. For problems with multiple zones, the argument
to <code>budget</code> can be a single <code>numeric</code> value to specify a budget
for the entire solution or a <code>numeric</code> <code>vector</code> to specify
a budget for each each management zone.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p><code>phylo</code> object specifying a phylogenetic tree
for the conservation features.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the objective
  added to it.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A problem objective is used to specify the overall goal of the
  conservation planning problem. Please note that all conservation
  planning problems formulated in the <span class="pkg">prioritizr</span> package require the
  addition of objectives---failing to do so will return an error
  message when attempting to solve problem.</p>
<p>The maximum phylogenetic diversity objective finds the set of
  planning units that meets representation targets for a phylogenetic tree
  while staying within a fixed budget. If multiple solutions can meet all
  targets while staying within budget, the cheapest solution is chosen.
  Note that this objective is similar to the maximum
  features objective (<code><a href='add_max_features_objective.html'>add_max_features_objective</a></code>) in that it
  allows for both a budget and targets to be set for each feature. However,
  unlike the maximum feature objective, the aim of this objective is to
  maximize the total phylogenetic diversity of the targets met in the
  solution, so if multiple targets are provided for a single feature, the
  problem will only need to meet a single target for that feature
  for the phylogenetic benefit for that feature to be counted when
  calculating the phylogenetic diversity of the solution. In other words,
  for multi-zone problems, this objective does not aim to maximize the
  phylogenetic diversity in each zone, but rather this objective
  aims to maximize the phylogenetic diversity of targets that can be met
  through allocating planning units to any of the different zones in a
  problem. This can be useful for problems where targets pertain to the total
  amount held for each feature across multiple zones. For example,
  each feature might have a non-zero amount of suitable habitat in each
  planning unit when the planning units are assigned to a (i) not restored,
  (ii) partially restored, or (iii) completely restored management zone.
  Here each target corresponds to a single feature and can be met through
  the total amount of habitat in planning units present to the three
  zones. In earlier versions of the <span class="pkg">prioritizr</span> package, this
  function was named <code>add_max_phylo_div_objective</code>.</p>
<p>The maximum phylogenetic diversity objective for the reserve design
  problem can be expressed mathematically for a set of planning units
  (\(I\) indexed by \(i\)) and a set of features (\(J\)
  indexed by \(j\)) as:</p>
<p>$$\mathit{Maximize} \space \sum_{i = 1}^{I} -s \space c_i \space x_i +
  \sum_{j = 1}^{J} m_b l_b \\
  \mathit{subject \space to} \\
  \sum_{i = 1}^{I} x_i r_{ij} \geq y_j t_j \forall j \in J \\
  m_b \leq y_j \forall j \in T(b) \\
  \sum_{i = 1}^{I} x_i c_i \leq B$$</p>
<p>Here, \(x_i\) is the <code><a href='decisions.html'>decisions</a></code> variable (e.g.
  specifying whether planning unit \(i\) has been selected (1) or not
  (0)), \(r_{ij}\) is the amount of feature \(j\) in planning
  unit \(i\), \(t_j\) is the representation target for feature
  \(j\), \(y_j\) indicates if the solution has meet
  the target \(t_j\) for feature \(j\). Additionally,
  \(T\) represents a phylogenetic tree containing features \(j\)
  and has the branches \(b\) associated within lengths \(l_b\).
  The binary variable \(m_b\) denotes if
  at least one feature associated with the branch \(b\) has met its
  representation as indicated by \(y_j\). For brevity, we denote
  the features \(j\) associated with branch \(b\) using
  \(T(b)\). Finally, \(B\) is the budget allocated for the
  solution, \(c_i\) is the cost of planning unit \(i\), and
  \(s\) is a scaling factor used to shrink the costs so that the problem
  will return a cheapest solution when there are multiple solutions that
  represent the same amount of all features within the budget.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Faith DP (1992) Conservation evaluation and phylogenetic diversity.
<em>Biological Conservation</em>, 61: 1--10.</p>
<p>Rodrigues ASL and Gaston KJ (2002) Maximising phylogenetic diversity in the
selection of networks of conservation areas. <em>Biological Conservation</em>,
105: 103--111.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='objectives.html'>objectives</a></code>, <code><a href='branch_matrix.html'>branch_matrix</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># load ape package</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>ape</span>)

<span class='co'># load data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>, <span class='no'>sim_phylogeny</span>, <span class='no'>sim_pu_zones_stack</span>,
     <span class='no'>sim_features_zones</span>)

<span class='co'># plot the simulated phylogeny</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>sim_phylogeny</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"phylogeny"</span>)</div><div class='img'><img src='add_max_phylo_div_objective-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create problem with a maximum phylogenetic diversity objective,</span>
<span class='co'># where each feature needs 10 % of its distribution to be secured for</span>
<span class='co'># it to be adequately conserved and a total budget of 1900</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_max_phylo_div_objective</span>(<span class='fl'>1900</span>, <span class='no'>sim_phylogeny</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fl'>0.1</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>()</div><div class='input'><span class='co'># solve problem</span>
<span class='no'>s1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p1</span>)</div><div class='output co'>#&gt; Optimize a model with 14 rows, 103 columns and 565 nonzeros
#&gt; Variable types: 0 continuous, 103 integer (103 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 2e+02]
#&gt;   Objective range  [4e-06, 1e+00]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [2e+03, 2e+03]
#&gt; Found heuristic solution: objective -0.0000000
#&gt; Presolve removed 5 rows and 5 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 9 rows, 98 columns, 555 nonzeros
#&gt; Variable types: 0 continuous, 98 integer (98 binary)
#&gt; Presolved: 9 rows, 98 columns, 555 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.344516e+00, 23 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0    5.34452    0    5   -0.00000    5.34452      -     -    0s
#&gt;      0     0    5.24678    0    6   -0.00000    5.24678      -     -    0s
#&gt; H    0     0                       2.9402664    5.24678  78.4%     -    0s
#&gt;      0     0    5.24429    0    7    2.94027    5.24429  78.4%     -    0s
#&gt;      0     0    5.24428    0    8    2.94027    5.24428  78.4%     -    0s
#&gt;      0     0    5.24405    0    8    2.94027    5.24405  78.4%     -    0s
#&gt;      0     0    5.24401    0    9    2.94027    5.24401  78.4%     -    0s
#&gt;      0     2    5.23706    0    9    2.94027    5.23706  78.1%     -    0s
#&gt; H    6     3                       3.5363171    4.24819  20.1%   8.0    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Cover: 1
#&gt;   MIR: 3
#&gt; 
#&gt; Explored 9 nodes (107 simplex iterations) in 0.02 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3.53632 2.94027 -0 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.536317127664e+00, best bound 3.833000595646e+00, gap 8.3896%</div><div class='input'>
<span class='co'># plot solution</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s1</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_max_phylo_div_objective-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># find which features have their targets met</span>
<span class='no'>r1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='feature_representation.html'>feature_representation</a></span>(<span class='no'>p1</span>, <span class='no'>s1</span>)
<span class='no'>r1</span>$<span class='no'>target_met</span> <span class='kw'>&lt;-</span> <span class='no'>r1</span>$<span class='no'>relative_held</span> <span class='kw'>&gt;</span> <span class='fl'>0.1</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>r1</span>)</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 5 x 4</span><span>
#&gt;   feature absolute_held relative_held target_met
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>           </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>         </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;lgl&gt;</span><span>     
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> layer.1          5.87        0.070</span><span style='text-decoration: underline;'>5</span><span> FALSE     
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> layer.2          3.18        0.102  TRUE      
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> layer.3          4.39        0.061</span><span style='text-decoration: underline;'>1</span><span> FALSE     
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> layer.4          4.37        0.102  TRUE      
#&gt; </span><span style='color: #BCBCBC;'>5</span><span> layer.5          4.43        0.078</span><span style='text-decoration: underline;'>1</span><span> FALSE     </div><div class='input'>
<span class='co'># plot the phylogeny and color the adequately represented features in red</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>sim_phylogeny</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"adequately represented features"</span>,
     <span class='kw'>tip.color</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/replace'>replace</a></span>(
       <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"black"</span>, <span class='fu'>nlayers</span>(<span class='no'>sim_features</span>)),
       <span class='no'>sim_phylogeny</span>$<span class='no'>tip.label</span> <span class='kw'>%in%</span> <span class='no'>r1</span>$<span class='no'>feature</span>[<span class='no'>r1</span>$<span class='no'>target_met</span>],
       <span class='st'>"red"</span>))</div><div class='img'><img src='add_max_phylo_div_objective-3.png' alt='' width='700' height='433' /></div></span><div class='input'><span class='co'># rename the features in the example phylogeny for use with the</span>
<span class='co'># multi-zone data</span>
<span class='no'>sim_phylogeny</span>$<span class='no'>tip.label</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='feature_names.html'>feature_names</a></span>(<span class='no'>sim_features_zones</span>)

<span class='co'># create targets for a multi-zone problem. Here, each feature needs a total</span>
<span class='co'># of 10 units of habitat to be conserved among the three zones to be</span>
<span class='co'># considered adequately conserved</span>
<span class='no'>targets</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>tibble</span><span class='kw ns'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span>(
  <span class='kw'>feature</span> <span class='kw'>=</span> <span class='fu'><a href='feature_names.html'>feature_names</a></span>(<span class='no'>sim_features_zones</span>),
  <span class='kw'>zone</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='zone_names.html'>zone_names</a></span>(<span class='no'>sim_features_zones</span>))[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,
          <span class='fu'><a href='number_of_features.html'>number_of_features</a></span>(<span class='no'>sim_features_zones</span>))],
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"absolute"</span>, <span class='fu'><a href='number_of_features.html'>number_of_features</a></span>(<span class='no'>sim_features_zones</span>)),
  <span class='kw'>target</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>10</span>, <span class='fu'><a href='number_of_features.html'>number_of_features</a></span>(<span class='no'>sim_features_zones</span>)))

<span class='co'># create a multi-zone problem with a maximum phylogenetic diversity</span>
<span class='co'># objective, where the total expenditure in all zones is 5000.</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_max_phylo_div_objective</span>(<span class='fl'>5000</span>, <span class='no'>sim_phylogeny</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_manual_targets.html'>add_manual_targets</a></span>(<span class='no'>targets</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>()</div><div class='input'><span class='co'># solve problem</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p2</span>)</div><div class='output co'>#&gt; Optimize a model with 104 rows, 283 columns and 1915 nonzeros
#&gt; Variable types: 0 continuous, 283 integer (283 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 2e+02]
#&gt;   Objective range  [1e-06, 1e+00]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 5e+03]
#&gt; Found heuristic solution: objective -0.0000000
#&gt; Presolve removed 97 rows and 187 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 7 rows, 96 columns, 460 nonzeros
#&gt; Variable types: 0 continuous, 96 integer (96 binary)
#&gt; Presolved: 7 rows, 96 columns, 460 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.055579e+00, 13 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0    5.05558    0    1   -0.00000    5.05558      -     -    0s
#&gt; H    0     0                       5.0555788    5.05558  0.00%     -    0s
#&gt; 
#&gt; Explored 1 nodes (13 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 5.05558 -0 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.055578773911e+00, best bound 5.055578773911e+00, gap 0.0000%</div><div class='input'>
<span class='co'># plot solution</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='no'>s2</span>), <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_max_phylo_div_objective-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># calculate total amount of habitat conserved for each feature among</span>
<span class='co'># all three management zones</span>
<span class='no'>amount_held2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></span>(<span class='fu'><a href='number_of_features.html'>number_of_features</a></span>(<span class='no'>sim_features_zones</span>))
<span class='kw'>for</span> (<span class='no'>z</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='number_of_zones.html'>number_of_zones</a></span>(<span class='no'>sim_features_zones</span>)))
  <span class='no'>amount_held2</span> <span class='kw'>&lt;-</span> <span class='no'>amount_held2</span> +
                  <span class='fu'>cellStats</span>(<span class='no'>sim_features_zones</span><span class='kw'>[[</span><span class='no'>z</span>]] * <span class='no'>s2</span><span class='kw'>[[</span><span class='no'>z</span>]], <span class='st'>"sum"</span>)

<span class='co'># find which features have their targets met</span>
<span class='no'>targets_met2</span> <span class='kw'>&lt;-</span> <span class='no'>amount_held2</span> <span class='kw'>&gt;=</span> <span class='no'>targets</span>$<span class='no'>target</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>targets_met2</span>)</div><div class='output co'>#&gt; layer.1 layer.2 layer.3 layer.4 layer.5 
#&gt;    TRUE   FALSE    TRUE    TRUE    TRUE </div><div class='input'>
<span class='co'># plot the phylogeny and color the adequately represented features in red</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>sim_phylogeny</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"adequately represented features"</span>,
     <span class='kw'>tip.color</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/replace'>replace</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"black"</span>, <span class='fu'>nlayers</span>(<span class='no'>sim_features</span>)),
                         <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/which'>which</a></span>(<span class='no'>targets_met2</span>), <span class='st'>"red"</span>))</div><div class='img'><img src='add_max_phylo_div_objective-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create a multi-zone problem with a maximum phylogenetic diversity</span>
<span class='co'># objective, where each zone has a separate budget.</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'>add_max_phylo_div_objective</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>2500</span>, <span class='fl'>500</span>, <span class='fl'>2000</span>), <span class='no'>sim_phylogeny</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_manual_targets.html'>add_manual_targets</a></span>(<span class='no'>targets</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>()</div><div class='input'><span class='co'># solve problem</span>
<span class='no'>s3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p3</span>)</div><div class='output co'>#&gt; Optimize a model with 106 rows, 283 columns and 1915 nonzeros
#&gt; Variable types: 0 continuous, 283 integer (283 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 2e+02]
#&gt;   Objective range  [1e-06, 1e+00]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+03]
#&gt; Found heuristic solution: objective -0.0000000
#&gt; Presolve removed 5 rows and 5 columns
#&gt; Presolve time: 0.00s
#&gt; Presolved: 101 rows, 278 columns, 1905 nonzeros
#&gt; Variable types: 0 continuous, 278 integer (278 binary)
#&gt; Presolved: 101 rows, 278 columns, 1905 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 5.319634e+00, 88 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0    5.31963    0    6   -0.00000    5.31963      -     -    0s
#&gt; H    0     0                       5.0555789    5.31963  5.22%     -    0s
#&gt; 
#&gt; Explored 1 nodes (88 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 5.05558 -0 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.055578938831e+00, best bound 5.319633591566e+00, gap 5.2230%</div><div class='input'>
<span class='co'># plot solution</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='no'>s3</span>), <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"solution"</span>, <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_max_phylo_div_objective-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># calculate total amount of habitat conserved for each feature among</span>
<span class='co'># all three management zones</span>
<span class='no'>amount_held3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></span>(<span class='fu'><a href='number_of_features.html'>number_of_features</a></span>(<span class='no'>sim_features_zones</span>))
<span class='kw'>for</span> (<span class='no'>z</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='number_of_zones.html'>number_of_zones</a></span>(<span class='no'>sim_features_zones</span>)))
  <span class='no'>amount_held3</span> <span class='kw'>&lt;-</span> <span class='no'>amount_held3</span> +
                  <span class='fu'>cellStats</span>(<span class='no'>sim_features_zones</span><span class='kw'>[[</span><span class='no'>z</span>]] * <span class='no'>s3</span><span class='kw'>[[</span><span class='no'>z</span>]], <span class='st'>"sum"</span>)

<span class='co'># find which features have their targets met</span>
<span class='no'>targets_met3</span> <span class='kw'>&lt;-</span> <span class='no'>amount_held3</span> <span class='kw'>&gt;=</span> <span class='no'>targets</span>$<span class='no'>target</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>targets_met3</span>)</div><div class='output co'>#&gt; layer.1 layer.2 layer.3 layer.4 layer.5 
#&gt;    TRUE   FALSE    TRUE    TRUE    TRUE </div><div class='input'>
<span class='co'># plot the phylogeny and color the adequately represented features in red</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>sim_phylogeny</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"adequately represented features"</span>,
     <span class='kw'>tip.color</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/replace'>replace</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"black"</span>, <span class='fu'>nlayers</span>(<span class='no'>sim_features</span>)),
                         <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/which'>which</a></span>(<span class='no'>targets_met3</span>), <span class='st'>"red"</span>))</div><div class='img'><img src='add_max_phylo_div_objective-7.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='https://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com'>Joseph Bennett</a>, <a href='http://www.possinghamlab.org'>Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>


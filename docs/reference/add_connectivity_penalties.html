<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add connectivity penalties — add_connectivity_penalties • prioritizr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Add connectivity penalties — add_connectivity_penalties" />
<meta property="og:description" content="Add penalties to a conservation planning problem to favor
solutions that select planning units with high connectivity between them." />
<meta property="og:image" content="https://prioritizr.net/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/saltspring.html">Salt Spring Island Tutorial</a>
    </li>
    <li>
      <a href="../articles/tasmania.html">Tasmania Tutorial</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add connectivity penalties</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_connectivity_penalties.R'><code>R/add_connectivity_penalties.R</code></a></small>
    <div class="hidden name"><code>add_connectivity_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add penalties to a conservation planning <code><a href='problem.html'>problem</a></code> to favor
solutions that select planning units with high connectivity between them.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for ConservationProblem,ANY,ANY,matrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,Matrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,dgCMatrix</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,data.frame</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)

<span class='co'># S4 method for ConservationProblem,ANY,ANY,array</span>
<span class='fu'>add_connectivity_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='no'>zones</span>, <span class='no'>data</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p><code>numeric</code> penalty that is used to scale the importance
of selecting planning units with strong connectivity between them compared
to the main problem objective (e.g. solution cost when the argument to
<code>x</code> has a minimum set objective set using
<code><a href='add_min_set_objective.html'>add_min_set_objective</a></code>). Higher <code>penalty</code> values
can be used to obtain solutions with a high degree of connectivity,
and smaller <code>penalty</code> values can be used to obtain solutions with a #'   small degree of connectivity. Note that negative <code>penalty</code> values can
be used to obtain solutions that have very little connectivity.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p><code>matrix</code> or <code>Matrix</code> object describing the
level of connectivity between different zones. Each row and column
corresponds to a different zone in the argument to <code>x</code>, and cell
values indicate the level of connectivity between each combination
of zones. Cell values along the diagonal of the matrix represent
the level of connectivity between planning units allocated to the
same zone. Cell values must lay between 1 and -1, where negative
values favor solutions with weak connectivity. The default argument to
<code>zones</code> is an identity matrix (i.e. a matrix with ones along the
matrix diagonal and zeros elsewhere), so that planning units are
only considered to be connected when they are allocated to the same zone.
This argument is required when the argument to <code>data</code> is a
<code>matrix</code> or <code>Matrix</code> object. If the argument to <code>data</code> is
an <code>array</code> or <code>data.frame</code> with zone data, this argument
must explicitly be set to <code>NULL</code> otherwise an error will be thrown.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>matrix</code>, <code>Matrix</code>, <code>data.frame</code>, or
<code>array</code> object containing connectivity data. The connectivity values
correspond to the strength of connectivity between
different planning units. Thus connections between planning units
that are associated with higher values are more favorable in the solution.
See the Details section for more information.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>not used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the penalties
 added to it.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses connectivity data to penalize solutions
  that have low connectivity. It can accommodate symmetric and asymmetric
  relationships between planning units. Although <em>Marxan</em>
  <strong>penalizes</strong> connections between planning units with high
  connectivity values, it is important to note that this function
  <strong>favors</strong> connections between planning units with high connectivity
  values. This function was inspired by Beger <em>et al.</em> (2010).</p>
<p>The argument to <code>data</code> can be specified in several different ways:</p>
<p></p><dl class='dl-horizontal'>
    <dt><code>matrix</code>, <code>Matrix</code></dt><dd><p>where rows and columns represent
    different planning units and the value of each cell represents the
    strength of connectivity between two different planning units. Cells
    that occur along the matrix diagonal are treated as weights which
    indicate that planning units are more desirable in the solution.
    The argument to <code>zones</code> can be used to control
    the strength of connectivity between planning units in different zones.
    The default argument for <code>zones</code> is to treat planning units
    allocated to different zones as having zero connectivity.</p></dd>
    <dt><code>data.frame</code></dt><dd><p>containing the fields (columns)
    <code>"id1"</code>, <code>"id2"</code>, and <code>"boundary"</code>. Here, each row
    denotes the connectivity between two planning units following the
    <em>Marxan</em> format. The data can be used to denote symmetric or
    asymmetric relationships between planning units. By default,
    input data is assumed to be symmetric unless asymmetric data is
    also included (e.g. if data is present for planning units 2 and 3, then
    the same amount of connectivity is expected for planning units 3 and 2,
    unless connectivity data is also provided for planning units 3 and 2).
    If the argument to <code>x</code> contains multiple zones, then the columns
    <code>"zone1"</code> and <code>"zone2"</code> can optionally be provided to manually
    specify the connectivity values between planning units when they are
    allocated to specific zones. If the columns <code>"zone1"</code> and
    <code>"zone2"</code> are present, then the argument to <code>zones</code> must be
    <code>NULL</code>.</p></dd>
    <dt><code>array</code></dt><dd><p>containing four-dimensions where cell values
    indicate the strength of connectivity between planning units
    when they are assigned to specific management zones. The first two
    dimensions (i.e. rows and columns) indicate the strength of
    connectivity between different planning units and the second two
    dimensions indicate the different management zones. Thus
    the <code>data[1, 2, 3, 4]</code> indicates the strength of
    connectivity between planning unit 1 and planning unit 2 when planning
    unit 1 is assigned to zone 3 and planning unit 2 is assigned to zone 4.</p></dd>
    </dl>
    <p>The connectivity penalties are calculated using the following equations.
 Let \(I\) represent the set of planning units
 (indexed by \(i\) or \(j\)), \(Z\) represent the set
 of management zones (indexed by \(z\) or \(y\)), and \(X_{iz}\)
 represent the decision variable for planning unit \(i\) for in zone
 \(z\) (e.g. with binary
 values one indicating if planning unit is allocated or not). Also, let
 \(p\) represent the argument to <code>penalty</code>, \(D\) represent the
 argument to <code>data</code>, and \(W\) represent the argument
 to <code>zones</code>.</p>
<p>If the argument to <code>data</code> is supplied as a <code>matrix</code> or
 <code>Matrix</code> object, then the penalties are calculated as:</p>
<p>$$
 \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} \sum_{y}^{Z} (-p \times X_{iz}
 \times X_{jy} \times D_{ij} \times W_{zy})$$</p>
<p>Otherwise, if the argument to <code>data</code> is supplied as a
 <code>data.frame</code> or <code>array</code> object, then the penalties are
 calculated as:</p>
<p>$$
 \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} \sum_{y}^{Z} (-p \times X_{iz}
 \times X_{jy} \times D_{ijzy})$$</p>
<p>Note that when the problem objective is to maximize some measure of
 benefit and not minimize some measure of cost, the term \(-p\) is
 replaced with \(p\).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Beger M, Linke S, Watts M, Game E, Treml E, Ball I, and Possingham, HP (2010)
Incorporating asymmetric connectivity into spatial decision making for
conservation, <em>Conservation Letters</em>, 3: 359--368.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='penalties.html'>penalties</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set seed for reproducibility</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>600</span>)

<span class='co'># load Matrix package for visualizing matrices</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>Matrix</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='input'>
<span class='co'># load data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features</span>, <span class='no'>sim_features_zones</span>)

<span class='co'># define function to rescale values between zero and one so that we</span>
<span class='co'># can compare solutions from different connectivity matrices</span>
<span class='no'>rescale</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>to</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>), <span class='no'>from</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/range'>range</a></span>(<span class='no'>x</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)) {
  (<span class='no'>x</span> - <span class='no'>from</span>[<span class='fl'>1</span>]) / <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diff'>diff</a></span>(<span class='no'>from</span>) * <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diff'>diff</a></span>(<span class='no'>to</span>) + <span class='no'>to</span>[<span class='fl'>1</span>]
}

<span class='co'># create basic problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='no'>sim_features</span>, <span class='st'>"cost"</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fl'>0.2</span>)

<span class='co'># create a symmetric connectivity matrix where the connectivity between</span>
<span class='co'># two planning units corresponds to their shared boundary length</span>
<span class='no'>b_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boundary_matrix.html'>boundary_matrix</a></span>(<span class='no'>sim_pu_polygons</span>)

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>b_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>b_matrix</span>[])

<span class='co'># visualize connectivity matrix</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>(<span class='no'>b_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create a symmetric connectivity matrix where the connectivity between</span>
<span class='co'># two planning units corresponds to their spatial proximity</span>
<span class='co'># i.e. planning units that are further apart share less connectivity</span>
<span class='no'>centroids</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rgeos</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/rgeos/topics/topo-unary-gCentroid'>gCentroid</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='kw'>byid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>d_matrix</span> <span class='kw'>&lt;-</span> (<span class='fl'>1</span> / (<span class='fu'><a href='as.html'>as</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/dist'>dist</a></span>(<span class='no'>centroids</span>@<span class='kw'>coords</span>), <span class='st'>"Matrix"</span>) + <span class='fl'>1</span>))

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>d_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>d_matrix</span>[])

<span class='co'># remove connections between planning units without connectivity to</span>
<span class='co'># reduce run-time</span>
<span class='no'>d_matrix</span>[<span class='no'>d_matrix</span> <span class='kw'>&lt;</span> <span class='fl'>0.7</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># visualize connectivity matrix</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>(<span class='no'>d_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create a symmetric connectivity matrix where the connectivity</span>
<span class='co'># between adjacent two planning units corresponds to their combined</span>
<span class='co'># value in a field in the planning unit attribute data</span>
<span class='co'># for example, this field could describe the extent of native vegetation in</span>
<span class='co'># each planning unit and we could use connectivity penalties to identify</span>
<span class='co'># solutions that cluster planning units together that both contain large</span>
<span class='co'># amounts of native vegetation</span>
<span class='no'>c_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='connectivity_matrix.html'>connectivity_matrix</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='st'>"cost"</span>)

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>c_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>c_matrix</span>[])

<span class='co'># visualize connectivity matrix</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>(<span class='no'>c_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create an asymmetric connectivity matrix. Here, connectivity occurs between</span>
<span class='co'># adjacent planning units and, due to rivers flowing southwards</span>
<span class='co'># through the study area, connectivity from northern planning units to</span>
<span class='co'># southern planning units is ten times stronger than the reverse.</span>
<span class='no'>ac_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>sim_pu_polygons</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>sim_pu_polygons</span>))
<span class='no'>ac_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>ac_matrix</span>, <span class='st'>"Matrix"</span>)
<span class='no'>adjacent_units</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rgeos</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/rgeos/topics/pred-binary-gIntersects'>gIntersects</a></span>(<span class='no'>sim_pu_polygons</span>, <span class='kw'>byid</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>sim_pu_polygons</span>))) {
  <span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>sim_pu_polygons</span>))) {
    <span class='co'># find if planning units are adjacent</span>
    <span class='kw'>if</span> (<span class='no'>adjacent_units</span>[<span class='no'>i</span>, <span class='no'>j</span>]) {
      <span class='co'># find if planning units lay north and south of each other</span>
      <span class='co'># i.e. they have the same x-coordinate</span>
      <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>1</span>] <span class='kw'>==</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>1</span>]) {
        <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>&gt;</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>2</span>]) {
          <span class='co'># if i is north of j add 10 units of connectivity</span>
          <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] + <span class='fl'>10</span>
        } <span class='kw'>else</span> <span class='kw'>if</span> (<span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>i</span>, <span class='fl'>2</span>] <span class='kw'>&lt;</span> <span class='no'>centroids</span>@<span class='kw'>coords</span>[<span class='no'>j</span>, <span class='fl'>2</span>]) {
          <span class='co'># if i is south of j add 1 unit of connectivity</span>
          <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='no'>ac_matrix</span>[<span class='no'>i</span>, <span class='no'>j</span>] + <span class='fl'>1</span>
        }
      }
    }
  }
}

<span class='co'># standardize matrix values to lay between zero and one</span>
<span class='no'>ac_matrix</span>[] <span class='kw'>&lt;-</span> <span class='fu'>rescale</span>(<span class='no'>ac_matrix</span>[])

<span class='co'># visualize asymmetric connectivity matrix</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>(<span class='no'>ac_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create penalties</span>
<span class='no'>penalties</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>25</span>)

<span class='co'># create problems using the different connectivity matrices and penalties</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>p1</span>,
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>b_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>b_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>c_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>c_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>1</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ac_matrix</span>),
           <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties</span>[<span class='fl'>2</span>], <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>ac_matrix</span>))

<span class='co'># assign names to the problems</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>p2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"basic problem"</span>,
               <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"b_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"d_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"c_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>),
               <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"ac_matrix ("</span>, <span class='no'>penalties</span>,<span class='st'>")"</span>))</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='no'>p2</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 3934.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.496032e+03, 16 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3496.03193    0    4 3934.62184 3496.03193  11.1%     -    0s
#&gt; H    0     0                    3585.9601335 3496.03193  2.51%     -    0s
#&gt; 
#&gt; Explored 1 nodes (16 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3585.96 3934.62 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.585960133519e+03, best bound 3.496031931890e+03, gap 2.5078%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 17287.196992
#&gt; Found heuristic solution: objective 3691.2885062
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.307193e+03, 159 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3307.19310    0   86 3691.28851 3307.19310  10.4%     -    0s
#&gt; H    0     0                    3433.8940898 3307.19310  3.69%     -    0s
#&gt; 
#&gt; Explored 1 nodes (159 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3433.89 3691.29 17287.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.433894089811e+03, best bound 3.307193102718e+03, gap 3.6897%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [8e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15487.196992
#&gt; Found heuristic solution: objective 3326.2885062
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.012030e+03, 174 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3012.03046    0  138 3326.28851 3012.03046  9.45%     -    0s
#&gt; 
#&gt; Explored 1 nodes (174 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 3326.29 15487.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.326288506226e+03, best bound 3.012030457072e+03, gap 9.4477%
#&gt; Optimize a model with 1601 rows, 888 columns and 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [7e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 11397.038660
#&gt; Found heuristic solution: objective 2915.9453686
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.277325e+03, 601 iterations, 0.03 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2277.32517    0  877 2915.94537 2277.32517  21.9%     -    0s
#&gt;      0     0 2282.91603    0  874 2915.94537 2282.91603  21.7%     -    3s
#&gt;      0     0 2288.19139    0  871 2915.94537 2288.19139  21.5%     -    3s
#&gt;      0     0 2288.19139    0  483 2915.94537 2288.19139  21.5%     -    3s
#&gt;      0     0 2295.81836    0  478 2915.94537 2295.81836  21.3%     -    3s
#&gt;      0     0 2299.18104    0  478 2915.94537 2299.18104  21.2%     -    3s
#&gt;      0     0 2310.18554    0  450 2915.94537 2310.18554  20.8%     -    3s
#&gt;      0     0 2314.83207    0  473 2915.94537 2314.83207  20.6%     -    3s
#&gt;      0     0 2316.71918    0  467 2915.94537 2316.71918  20.5%     -    3s
#&gt;      0     0 2316.71918    0  467 2915.94537 2316.71918  20.5%     -    4s
#&gt; H    0     0                    2879.5923214 2316.71918  19.5%     -    4s
#&gt;      0     2 2316.75143    0  467 2879.59232 2316.75143  19.5%     -    4s
#&gt; H   53    53                    2669.2652017 2367.46532  11.3%  45.8    4s
#&gt; H  273   209                    2665.1537029 2389.53644  10.3%  56.5    4s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 6
#&gt; 
#&gt; Explored 330 nodes (18882 simplex iterations) in 4.96 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 5: 2665.15 2669.27 2879.59 ... 11397
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.665153702866e+03, best bound 2.411089064269e+03, gap 9.5328%
#&gt; Optimize a model with 1601 rows, 888 columns and 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 761.8011610
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; Variable types: 0 continuous, 888 integer (888 binary)
#&gt; Presolved: 1601 rows, 888 columns, 3642 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.267850e+02, 243 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0  126.78496    0  695  761.80116  126.78496  83.4%     -    0s
#&gt; H    0     0                     468.0158310  126.78496  72.9%     -    0s
#&gt;      0     0  139.58775    0  693  468.01583  139.58775  70.2%     -    2s
#&gt;      0     0  148.83710    0  691  468.01583  148.83710  68.2%     -    2s
#&gt;      0     0  148.83710    0  382  468.01583  148.83710  68.2%     -    2s
#&gt;      0     0  161.29257    0  380  468.01583  161.29257  65.5%     -    3s
#&gt;      0     0  170.44305    0  348  468.01583  170.44305  63.6%     -    3s
#&gt;      0     0  182.28500    0  352  468.01583  182.28500  61.1%     -    3s
#&gt; H    0     0                     454.2214760  182.28500  59.9%     -    3s
#&gt;      0     0  194.23505    0  378  454.22148  194.23505  57.2%     -    3s
#&gt;      0     0  194.23505    0  378  454.22148  194.23505  57.2%     -    3s
#&gt;      0     2  195.12431    0  378  454.22148  195.12431  57.0%     -    3s
#&gt; H    1     1                     423.4053090  195.12431  53.9%   0.0    3s
#&gt; *   49     3               2     421.3259805  329.15212  21.9%  41.5    3s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 52 nodes (2800 simplex iterations) in 3.63 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 5: 421.326 423.405 454.221 ... 761.801
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.213259804528e+02, best bound 3.823629791434e+02, gap 9.2477%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [9e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15721.108025
#&gt; Found heuristic solution: objective 3513.2283384
#&gt; Presolve time: 0.00s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.099126e+03, 223 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3099.12568    0  190 3513.22834 3099.12568  11.8%     -    0s
#&gt;      0     0 3106.44940    0  164 3513.22834 3106.44940  11.6%     -    0s
#&gt; H    0     0                    3244.5496513 3106.44940  4.26%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 1
#&gt; 
#&gt; Explored 1 nodes (267 simplex iterations) in 0.04 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3244.55 3513.23 15721.1 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.244549651264e+03, best bound 3.106449395648e+03, gap 4.2564%
#&gt; Optimize a model with 581 rows, 378 columns and 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 11571.974576
#&gt; Found heuristic solution: objective 2881.1380866
#&gt; Presolve time: 0.01s
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; Variable types: 0 continuous, 378 integer (378 binary)
#&gt; Presolved: 581 rows, 378 columns, 1602 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.309063e+03, 214 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2309.06312    0  362 2881.13809 2309.06312  19.9%     -    0s
#&gt;      0     0 2328.00732    0  359 2881.13809 2328.00732  19.2%     -    0s
#&gt;      0     0 2339.73282    0  365 2881.13809 2339.73282  18.8%     -    0s
#&gt;      0     0 2339.73282    0  224 2881.13809 2339.73282  18.8%     -    0s
#&gt;      0     0 2346.29691    0  224 2881.13809 2346.29691  18.6%     -    0s
#&gt;      0     0 2357.20173    0  222 2881.13809 2357.20173  18.2%     -    0s
#&gt;      0     0 2360.84727    0  226 2881.13809 2360.84727  18.1%     -    0s
#&gt;      0     0 2376.63837    0  223 2881.13809 2376.63837  17.5%     -    0s
#&gt;      0     0 2376.63837    0  223 2881.13809 2376.63837  17.5%     -    0s
#&gt; H    0     0                    2633.0995862 2376.63837  9.74%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 4
#&gt; 
#&gt; Explored 1 nodes (717 simplex iterations) in 0.43 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 2633.1 2881.14 11572 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.633099586223e+03, best bound 2.376638371787e+03, gap 9.7399%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 17098.178722
#&gt; Found heuristic solution: objective 3824.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.385781e+03, 49 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3385.78126    0   24 3824.62184 3385.78126  11.5%     -    0s
#&gt; H    0     0                    3506.9306268 3385.78126  3.45%     -    0s
#&gt; 
#&gt; Explored 1 nodes (49 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3506.93 3824.62 17098.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.506930626812e+03, best bound 3.385781260518e+03, gap 3.4546%
#&gt; Optimize a model with 293 rows, 234 columns and 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 1e+01]
#&gt; Found heuristic solution: objective 15910.178722
#&gt; Found heuristic solution: objective 3659.6218396
#&gt; Presolve time: 0.00s
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; Variable types: 0 continuous, 234 integer (234 binary)
#&gt; Presolved: 293 rows, 234 columns, 1026 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.172486e+03, 93 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3172.48586    0   64 3659.62184 3172.48586  13.3%     -    0s
#&gt; H    0     0                    3386.1100237 3172.48586  6.31%     -    0s
#&gt; 
#&gt; Explored 1 nodes (93 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 3386.11 3659.62 15910.2 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 3.386110023737e+03, best bound 3.172485864952e+03, gap 6.3088%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_along</a></span>(<span class='no'>s2</span>)) {
  <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>p2</span>)[<span class='no'>i</span>], <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>1.5</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"white"</span>)
  <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]][<span class='no'>s2</span><span class='kw'>[[</span><span class='no'>i</span>]]$<span class='no'>solution_1</span> <span class='kw'>==</span> <span class='fl'>1</span>, ], <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"darkgreen"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
}</div><div class='img'><img src='add_connectivity_penalties-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create minimal multi-zone problem and limit solver to one minute</span>
<span class='co'># to obtain solutions in a short period of time</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0.15</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>(<span class='kw'>time_limit</span> <span class='kw'>=</span> <span class='fl'>60</span>)

<span class='co'># create matrix showing which planning units are adjacent to other units</span>
<span class='no'>a_matrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='connected_matrix.html'>connected_matrix</a></span>(<span class='no'>sim_pu_zones_stack</span>)

<span class='co'># visualize matrix</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/image'>image</a></span>(<span class='no'>a_matrix</span>)</div><div class='img'><img src='add_connectivity_penalties-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create a zone matrix where connectivities are only present between</span>
<span class='co'># planning units that are allocated to the same zone</span>
<span class='no'>zm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>3</span>), <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm1</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    .    .
#&gt; [2,]    .    1    .
#&gt; [3,]    .    .    1</div><div class='input'>
<span class='co'># create a zone matrix where connectivities are strongest between</span>
<span class='co'># planning units allocated to different zones</span>
<span class='no'>zm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>zm2</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>zm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm2</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm2</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    1
#&gt; [3,]    1    1    0</div><div class='input'>
<span class='co'># create a zone matrix that indicates that connectivities between planning</span>
<span class='co'># units assigned to the same zone are much higher than connectivities</span>
<span class='co'># assigned to different zones</span>
<span class='no'>zm3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0.1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>zm3</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm3</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm3</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.1  0.1
#&gt; [2,]  0.1  1.0  0.1
#&gt; [3,]  0.1  0.1  1.0</div><div class='input'>
<span class='co'># create a zone matrix that indicates that connectivities between planning</span>
<span class='co'># units allocated to zone 1 are very high, connectivities between planning</span>
<span class='co'># units allocated to zones 1 and 2 are moderately high, and connectivities</span>
<span class='co'># planning units allocated to other zones are low</span>
<span class='no'>zm4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0.1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>zm4</span>[<span class='fl'>1</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm4</span>[<span class='fl'>1</span>, <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm4</span>[<span class='fl'>2</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm4</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm4</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.5  0.1
#&gt; [2,]  0.5  0.1  0.1
#&gt; [3,]  0.1  0.1  0.1</div><div class='input'>
<span class='co'># create a zone matrix with strong connectivities between planning units</span>
<span class='co'># allocated to the same zone, moderate connectivities between planning</span>
<span class='co'># unit allocated to zone 1 and zone 2, and negative connectivities between</span>
<span class='co'># planning units allocated to zone 3 and the other two zones</span>
<span class='no'>zm5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(-<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>zm5</span>[<span class='fl'>1</span>, <span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>zm5</span>[<span class='fl'>2</span>, <span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>zm5</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>zm5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='as.html'>as</a></span>(<span class='no'>zm5</span>, <span class='st'>"Matrix"</span>)

<span class='co'># print zone matrix</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm5</span>)</div><div class='output co'>#&gt; 3 x 3 Matrix of class "dsyMatrix"
#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.5   -1
#&gt; [2,]  0.5  1.0   -1
#&gt; [3,] -1.0 -1.0    1</div><div class='input'>
<span class='co'># create vector of penalties to use creating problems</span>
<span class='no'>penalties2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>15</span>)

<span class='co'># create multi-zone problems using the adjacent connectivity matrix and</span>
<span class='co'># different zone matrices</span>
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(
  <span class='no'>p3</span>,
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm1</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm1</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm2</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm2</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm3</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm3</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm4</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm4</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>1</span>], <span class='no'>zm5</span>, <span class='no'>a_matrix</span>),
  <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='no'>penalties2</span>[<span class='fl'>2</span>], <span class='no'>zm5</span>, <span class='no'>a_matrix</span>))

<span class='co'># assign names to the problems</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>p4</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"basic problem"</span>,
               <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"zm"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fl'>5</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>2</span>), <span class='st'>" ("</span>,
                      <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='no'>penalties2</span>, <span class='fl'>2</span>), <span class='st'>")"</span>))</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='no'>p4</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10275.924144
#&gt; Presolve time: 0.00s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.943504e+03, 123 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8943.50352    0   15 10275.9241 8943.50352  13.0%     -    0s
#&gt; H    0     0                    9111.3117236 8943.50352  1.84%     -    0s
#&gt; 
#&gt; Explored 1 nodes (123 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9111.31 10275.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.111311723633e+03, best bound 8.943503517801e+03, gap 1.8418%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10075.924144
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.367447e+03, 811 iterations, 0.04 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8367.44688    0  465 10075.9241 8367.44688  17.0%     -    0s
#&gt; H    0     0                    9108.8765843 8367.44688  8.14%     -    0s
#&gt; 
#&gt; Explored 1 nodes (811 simplex iterations) in 0.07 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9108.88 10075.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.108876584257e+03, best bound 8.367446876836e+03, gap 8.1396%
#&gt; Optimize a model with 1845 rows, 1140 columns and 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9675.9241439
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; Variable types: 0 continuous, 1140 integer (1140 binary)
#&gt; Presolved: 1845 rows, 1140 columns, 5100 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 6.996298e+03, 692 iterations, 0.04 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 6996.29839    0  729 9675.92414 6996.29839  27.7%     -    0s
#&gt; H    0     0                    8807.8911596 6996.29839  20.6%     -    0s
#&gt; H    0     0                    8300.3896759 6996.29839  15.7%     -    0s
#&gt;      0     0 7007.48702    0  740 8300.38968 7007.48702  15.6%     -    0s
#&gt;      0     0 7012.71987    0  684 8300.38968 7012.71987  15.5%     -    0s
#&gt;      0     0 7025.27837    0  690 8300.38968 7025.27837  15.4%     -    0s
#&gt;      0     0 7025.27837    0  452 8300.38968 7025.27837  15.4%     -    0s
#&gt; H    0     0                    8293.4581834 7025.27837  15.3%     -    0s
#&gt;      0     0 7038.98808    0  449 8293.45818 7038.98808  15.1%     -    0s
#&gt;      0     0 7047.73583    0  462 8293.45818 7047.73583  15.0%     -    0s
#&gt;      0     0 7050.56904    0  455 8293.45818 7050.56904  15.0%     -    0s
#&gt;      0     0 7062.50531    0  473 8293.45818 7062.50531  14.8%     -    0s
#&gt; H    0     0                    8026.6363727 7062.50531  12.0%     -    0s
#&gt;      0     0 7063.36493    0  483 8026.63637 7063.36493  12.0%     -    0s
#&gt;      0     0 7063.36493    0  483 8026.63637 7063.36493  12.0%     -    0s
#&gt; H    0     0                    7719.1380957 7063.36493  8.50%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 9
#&gt; 
#&gt; Explored 1 nodes (1944 simplex iterations) in 0.81 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 6: 7719.14 8026.64 8293.46 ... 9675.92
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 7.719138095745e+03, best bound 7.063364932526e+03, gap 8.4954%
#&gt; Optimize a model with 3585 rows, 2010 columns and 8580 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9985.9241439
#&gt; Presolve time: 0.05s
#&gt; Presolved: 3585 rows, 2010 columns, 12060 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 2715 rows, 2010 columns, 9450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.346175e+03, 2630 iterations, 0.16 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8346.17500    0  329 9985.92414 8346.17500  16.4%     -    0s
#&gt; H    0     0                    8807.8710351 8346.17500  5.24%     -    0s
#&gt; 
#&gt; Explored 1 nodes (2996 simplex iterations) in 0.25 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 8807.87 9985.92 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 8.807871035125e+03, best bound 8.346175000834e+03, gap 5.2419%
#&gt; Optimize a model with 3585 rows, 2010 columns and 8580 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9405.9241439
#&gt; Presolve time: 0.06s
#&gt; Presolved: 3585 rows, 2010 columns, 12060 nonzeros
#&gt; Variable types: 0 continuous, 2010 integer (2010 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 2715 rows, 2010 columns, 9450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 6.957796e+03, 2822 iterations, 0.18 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 6957.79614    0  362 9405.92414 6957.79614  26.0%     -    0s
#&gt; H    0     0                    7880.3220201 6957.79614  11.7%     -    0s
#&gt; H    0     0                    7585.3205877 6957.79614  8.27%     -    0s
#&gt; 
#&gt; Explored 1 nodes (3247 simplex iterations) in 0.33 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 7585.32 7880.32 9405.92 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 7.585320587699e+03, best bound 6.957796139168e+03, gap 8.2729%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e-01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10046.924144
#&gt; Presolve time: 0.11s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.343967e+03, 2550 iterations, 0.21 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8343.96746    0  835 10046.9241 8343.96746  17.0%     -    0s
#&gt; H    0     0                    9212.6916242 8343.96746  9.43%     -    0s
#&gt; 
#&gt; Explored 1 nodes (2792 simplex iterations) in 0.38 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9212.69 10046.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.212691624211e+03, best bound 8.343967460484e+03, gap 9.4296%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9588.9241439
#&gt; Presolve time: 0.11s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 6.879922e+03, 3019 iterations, 0.30 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 6879.92223    0 1025 9588.92414 6879.92223  28.3%     -    0s
#&gt; H    0     0                    8207.6583757 6879.92223  16.2%     -    0s
#&gt;      0     0 6886.40574    0 1017 8207.65838 6886.40574  16.1%     -    0s
#&gt;      0     0 6889.44311    0 1014 8207.65838 6889.44311  16.1%     -    0s
#&gt;      0     0 6897.13414    0 1048 8207.65838 6897.13414  16.0%     -    1s
#&gt;      0     0 6903.32118    0 1010 8207.65838 6903.32118  15.9%     -    1s
#&gt;      0     0 6903.36701    0 1010 8207.65838 6903.36701  15.9%     -    1s
#&gt;      0     0 6904.78908    0 1049 8207.65838 6904.78908  15.9%     -    1s
#&gt;      0     0 6907.09275    0 1063 8207.65838 6907.09275  15.8%     -    1s
#&gt;      0     0 6910.94923    0 1111 8207.65838 6910.94923  15.8%     -    1s
#&gt;      0     0 6912.92708    0 1108 8207.65838 6912.92708  15.8%     -    1s
#&gt;      0     0 6913.91403    0 1107 8207.65838 6913.91403  15.8%     -    1s
#&gt;      0     0 6916.42638    0 1101 8207.65838 6916.42638  15.7%     -    1s
#&gt;      0     0 6916.91762    0 1100 8207.65838 6916.91762  15.7%     -    2s
#&gt;      0     0 6917.38884    0 1100 8207.65838 6917.38884  15.7%     -    2s
#&gt;      0     0 6918.88208    0 1096 8207.65838 6918.88208  15.7%     -    2s
#&gt;      0     0 6919.15347    0 1020 8207.65838 6919.15347  15.7%     -    2s
#&gt;      0     0 6919.64373    0 1019 8207.65838 6919.64373  15.7%     -    2s
#&gt;      0     0 6920.13400    0 1018 8207.65838 6920.13400  15.7%     -    2s
#&gt;      0     0 6920.53268    0 1010 8207.65838 6920.53268  15.7%     -    2s
#&gt;      0     0 6921.31340    0 1011 8207.65838 6921.31340  15.7%     -    3s
#&gt;      0     0 6921.56168    0 1047 8207.65838 6921.56168  15.7%     -    3s
#&gt;      0     0 6922.06417    0 1047 8207.65838 6922.06417  15.7%     -    3s
#&gt;      0     0 6922.56354    0 1046 8207.65838 6922.56354  15.7%     -    3s
#&gt;      0     0 6923.05570    0 1033 8207.65838 6923.05570  15.7%     -    3s
#&gt;      0     0 6923.54288    0 1034 8207.65838 6923.54288  15.6%     -    3s
#&gt;      0     0 6924.02554    0 1041 8207.65838 6924.02554  15.6%     -    3s
#&gt;      0     0 6924.44575    0 1054 8207.65838 6924.44575  15.6%     -    4s
#&gt;      0     0 6924.92491    0 1046 8207.65838 6924.92491  15.6%     -    4s
#&gt;      0     0 6925.75149    0 1048 8207.65838 6925.75149  15.6%     -    4s
#&gt;      0     0 6927.32079    0 1041 8207.65838 6927.32079  15.6%     -    4s
#&gt;      0     0 6929.26300    0 1032 8207.65838 6929.26300  15.6%     -    4s
#&gt;      0     0 6929.65907    0 1036 8207.65838 6929.65907  15.6%     -    4s
#&gt;      0     0 6931.25127    0 1029 8207.65838 6931.25127  15.6%     -    5s
#&gt;      0     0 6932.35022    0 1037 8207.65838 6932.35022  15.5%     -    5s
#&gt;      0     0 6933.82641    0 1017 8207.65838 6933.82641  15.5%     -    5s
#&gt;      0     0 6934.42565    0 1041 8207.65838 6934.42565  15.5%     -    5s
#&gt;      0     0 6935.17619    0 1042 8207.65838 6935.17619  15.5%     -    5s
#&gt;      0     0 6935.23706    0 1035 8207.65838 6935.23706  15.5%     -    5s
#&gt;      0     0 6937.00731    0 1026 8207.65838 6937.00731  15.5%     -    6s
#&gt;      0     0 6937.04579    0 1021 8207.65838 6937.04579  15.5%     -    6s
#&gt;      0     0 6937.59042    0 1017 8207.65838 6937.59042  15.5%     -    6s
#&gt;      0     0 6937.59042    0 1017 8207.65838 6937.59042  15.5%     -    6s
#&gt; H    0     0                    7772.2754813 6937.59042  10.7%     -    7s
#&gt; H    0     0                    7516.9431913 6937.59042  7.71%     -    7s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 6
#&gt;   Zero half: 99
#&gt; 
#&gt; Explored 1 nodes (5552 simplex iterations) in 7.59 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 4: 7516.94 7772.28 8207.66 9588.92 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 7.516943191288e+03, best bound 6.937590417979e+03, gap 7.7073%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [5e-01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10118.924144
#&gt; Presolve time: 0.12s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.569664e+03, 2956 iterations, 0.26 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8569.66432    0  836 10118.9241 8569.66432  15.3%     -    0s
#&gt; H    0     0                    9381.9905191 8569.66432  8.66%     -    0s
#&gt; 
#&gt; Explored 1 nodes (3447 simplex iterations) in 0.46 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9381.99 10118.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.381990519089e+03, best bound 8.569664324288e+03, gap 8.6584%
#&gt; Optimize a model with 5325 rows, 2880 columns and 12060 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9804.9241439
#&gt; Presolve time: 0.42s
#&gt; Presolved: 5325 rows, 2880 columns, 17280 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 4455 rows, 2880 columns, 14670 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 7.568330e+03, 3103 iterations, 0.63 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 7568.33011    0 1001 9804.92414 7568.33011  22.8%     -    1s
#&gt; H    0     0                    9244.0142847 7568.33011  18.1%     -    1s
#&gt; H    0     0                    8544.1894455 7568.33011  11.4%     -    1s
#&gt;      0     0 7591.58588    0 1190 8544.18945 7591.58588  11.1%     -    1s
#&gt;      0     0 7593.30240    0 1193 8544.18945 7593.30240  11.1%     -    2s
#&gt;      0     0 7614.90367    0 1034 8544.18945 7614.90367  10.9%     -    2s
#&gt;      0     0 7615.08830    0 1113 8544.18945 7615.08830  10.9%     -    2s
#&gt;      0     0 7628.17570    0 1141 8544.18945 7628.17570  10.7%     -    2s
#&gt;      0     0 7628.31022    0 1252 8544.18945 7628.31022  10.7%     -    2s
#&gt;      0     0 7644.91594    0 1197 8544.18945 7644.91594  10.5%     -    3s
#&gt;      0     0 7644.91594    0 1200 8544.18945 7644.91594  10.5%     -    3s
#&gt;      0     0 7655.58429    0 1216 8544.18945 7655.58429  10.4%     -    3s
#&gt;      0     0 7655.58429    0 1217 8544.18945 7655.58429  10.4%     -    3s
#&gt;      0     0 7660.00975    0 1226 8544.18945 7660.00975  10.3%     -    3s
#&gt;      0     0 7660.13285    0 1229 8544.18945 7660.13285  10.3%     -    3s
#&gt;      0     0 7667.12822    0 1227 8544.18945 7667.12822  10.3%     -    3s
#&gt;      0     0 7667.81274    0 1237 8544.18945 7667.81274  10.3%     -    3s
#&gt;      0     0 7667.81274    0 1238 8544.18945 7667.81274  10.3%     -    3s
#&gt;      0     0 7680.28210    0 1151 8544.18945 7680.28210  10.1%     -    3s
#&gt;      0     0 7681.03438    0 1195 8544.18945 7681.03438  10.1%     -    3s
#&gt;      0     0 7681.03438    0 1196 8544.18945 7681.03438  10.1%     -    3s
#&gt;      0     0 7699.30074    0 1192 8544.18945 7699.30074  9.89%     -    3s
#&gt; 
#&gt; Cutting planes:
#&gt;   Zero half: 141
#&gt; 
#&gt; Explored 1 nodes (7680 simplex iterations) in 3.99 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 3: 8544.19 9244.01 9804.92 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 8.544189445540e+03, best bound 7.699300743229e+03, gap 9.8885%
#&gt; Optimize a model with 6485 rows, 2880 columns and 15540 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10084.071885
#&gt; Presolve time: 0.14s
#&gt; Presolved: 6485 rows, 2880 columns, 21920 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 5615 rows, 2880 columns, 19310 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.178938e+03, 1514 iterations, 0.20 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8178.93759    0  960 10084.0719 8178.93759  18.9%     -    0s
#&gt; H    0     0                    9010.5140391 8178.93759  9.23%     -    0s
#&gt; 
#&gt; Explored 1 nodes (1514 simplex iterations) in 0.44 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9010.51 10084.1 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.010514039144e+03, best bound 8.178937587478e+03, gap 9.2290%
#&gt; Optimize a model with 6485 rows, 2880 columns and 15540 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [8e+00, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9594.0718845
#&gt; Presolve time: 0.13s
#&gt; Presolved: 6485 rows, 2880 columns, 21920 nonzeros
#&gt; Variable types: 0 continuous, 2880 integer (2880 binary)
#&gt; Presolve removed 870 rows and 0 columns
#&gt; Presolved: 5615 rows, 2880 columns, 19310 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 6.327933e+03, 1328 iterations, 0.32 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 6327.93284    0 1112 9594.07188 6327.93284  34.0%     -    0s
#&gt; H    0     0                    8893.6505996 6327.93284  28.8%     -    0s
#&gt; H    0     0                    8350.6178501 6327.93284  24.2%     -    0s
#&gt;      0     0 6349.08567    0 1095 8350.61785 6349.08567  24.0%     -    0s
#&gt;      0     0 6359.02564    0 1102 8350.61785 6359.02564  23.8%     -    1s
#&gt;      0     0 6361.68522    0 1102 8350.61785 6361.68522  23.8%     -    1s
#&gt;      0     0 6372.77079    0 1086 8350.61785 6372.77079  23.7%     -    1s
#&gt;      0     0 6381.34325    0 1084 8350.61785 6381.34325  23.6%     -    1s
#&gt;      0     0 6382.30710    0 1190 8350.61785 6382.30710  23.6%     -    1s
#&gt;      0     0 6396.92183    0 1186 8350.61785 6396.92183  23.4%     -    1s
#&gt;      0     0 6397.77410    0 1187 8350.61785 6397.77410  23.4%     -    1s
#&gt;      0     0 6401.08834    0 1183 8350.61785 6401.08834  23.3%     -    1s
#&gt;      0     0 6403.24272    0 1184 8350.61785 6403.24272  23.3%     -    2s
#&gt;      0     0 6405.93204    0 1181 8350.61785 6405.93204  23.3%     -    2s
#&gt;      0     0 6408.56885    0 1182 8350.61785 6408.56885  23.3%     -    2s
#&gt;      0     0 6411.98230    0 1209 8350.61785 6411.98230  23.2%     -    2s
#&gt;      0     0 6411.98230    0 1210 8350.61785 6411.98230  23.2%     -    2s
#&gt;      0     0 6413.78362    0 1207 8350.61785 6413.78362  23.2%     -    3s
#&gt;      0     0 6416.51231    0 1207 8350.61785 6416.51231  23.2%     -    3s
#&gt;      0     0 6416.51231    0 1206 8350.61785 6416.51231  23.2%     -    3s
#&gt;      0     0 6418.35022    0 1207 8350.61785 6418.35022  23.1%     -    3s
#&gt;      0     0 6420.53839    0 1208 8350.61785 6420.53839  23.1%     -    4s
#&gt;      0     0 6420.62628    0 1208 8350.61785 6420.62628  23.1%     -    4s
#&gt; H    0     0                    8264.6239086 6420.62628  22.3%     -    4s
#&gt;      0     0 6433.98076    0 1202 8264.62391 6433.98076  22.2%     -    4s
#&gt;      0     0 6439.39644    0 1198 8264.62391 6439.39644  22.1%     -    4s
#&gt;      0     0 6445.46192    0 1188 8264.62391 6445.46192  22.0%     -    5s
#&gt;      0     0 6445.99828    0 1185 8264.62391 6445.99828  22.0%     -    5s
#&gt;      0     0 6446.01262    0 1185 8264.62391 6446.01262  22.0%     -    5s
#&gt;      0     0 6446.29655    0 1196 8264.62391 6446.29655  22.0%     -    5s
#&gt;      0     0 6446.29655    0 1196 8264.62391 6446.29655  22.0%     -    9s
#&gt; H    0     0                    7792.1822762 6446.29655  17.3%     -   10s
#&gt; H    0     0                    7749.6342428 6446.29655  16.8%     -   11s
#&gt;      0     0 6906.28153    0  837 7749.63424 6906.28153  10.9%     -   12s
#&gt; H    0     0                    7633.8881941 6906.28153  9.53%     -   13s
#&gt; 
#&gt; Explored 1 nodes (5858 simplex iterations) in 13.08 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 7: 7633.89 7749.63 7792.18 ... 9594.07
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 7.633888194093e+03, best bound 6.906281526489e+03, gap 9.5313%</div><div class='input'><span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='no'>s4</span>, <span class='no'>category_layer</span>)
<span class='no'>s4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/stack'>stack</a></span>(<span class='no'>s4</span>)

<span class='co'># plot solutions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s4</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>p4</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_connectivity_penalties-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># create an array to manually specify the connectivities between</span>
<span class='co'># each planning unit when they are allocated to each different zone</span>
<span class='co'># for real-world problems, these connectivities would be generated using</span>
<span class='co'># data - but here these connectivity values are assigned as random</span>
<span class='co'># ones or zeros</span>
<span class='no'>c_array</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/array'>array</a></span>(<span class='fl'>0</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fu'><a href='OptimizationProblem-methods.html'>ncell</a></span>(<span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='fl'>2</span>), <span class='fl'>3</span>, <span class='fl'>3</span>))
<span class='kw'>for</span> (<span class='no'>z1</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fl'>3</span>))
  <span class='kw'>for</span> (<span class='no'>z2</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fl'>3</span>))
    <span class='no'>c_array</span>[, , <span class='no'>z1</span>, <span class='no'>z2</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fu'><a href='OptimizationProblem-methods.html'>ncell</a></span>(<span class='no'>sim_pu_zones_stack</span><span class='kw'>[[</span><span class='fl'>1</span>]]) ^ <span class='fl'>2</span>,
                                       <span class='fl'>0</span>, <span class='fl'>0.505</span>))

<span class='co'># create a problem with the manually specified connectivity array</span>
<span class='co'># note that the zones argument is set to NULL because the connectivity</span>
<span class='co'># data is an array</span>
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>p3</span>,
           <span class='no'>p3</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_connectivity_penalties</span>(<span class='fl'>15</span>, <span class='kw'>zones</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>c_array</span>))


<span class='co'># assign names to the problems</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>p5</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"basic problem"</span>, <span class='st'>"connectivity array"</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='no'>p5</span>, <span class='no'>solve</span>)</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 10275.924144
#&gt; Presolve time: 0.00s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 8.943504e+03, 123 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 8943.50352    0   15 10275.9241 8943.50352  13.0%     -    0s
#&gt; H    0     0                    9111.3117236 8943.50352  1.84%     -    0s
#&gt; 
#&gt; Explored 1 nodes (123 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 2: 9111.31 10275.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 9.111311723633e+03, best bound 8.943503517801e+03, gap 1.8418%
#&gt; Optimize a model with 1479 rows, 957 columns and 4368 nonzeros
#&gt; Variable types: 0 continuous, 957 integer (957 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 1e+01]
#&gt; Found heuristic solution: objective 9930.9241439
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1479 rows, 957 columns, 4412 nonzeros
#&gt; Variable types: 0 continuous, 957 integer (957 binary)
#&gt; Presolve removed 22 rows and 0 columns
#&gt; Presolved: 1457 rows, 957 columns, 4346 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 7.525786e+03, 1105 iterations, 0.05 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 7525.78580    0  737 9930.92414 7525.78580  24.2%     -    0s
#&gt; H    0     0                    9151.9154000 7525.78580  17.8%     -    0s
#&gt; H    0     0                    8732.2878572 7525.78580  13.8%     -    0s
#&gt;      0     0 7536.84587    0  730 8732.28786 7536.84587  13.7%     -    1s
#&gt; H    0     0                    8729.6386402 7536.84587  13.7%     -    1s
#&gt;      0     0 7542.07300    0  687 8729.63864 7542.07300  13.6%     -    1s
#&gt;      0     0 7555.50875    0  738 8729.63864 7555.50875  13.4%     -    1s
#&gt;      0     0 7555.60253    0  738 8729.63864 7555.60253  13.4%     -    1s
#&gt;      0     0 7555.60253    0  737 8729.63864 7555.60253  13.4%     -    1s
#&gt; H    0     0                    8344.7530888 7555.60253  9.46%     -    1s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 3
#&gt;   Zero half: 13
#&gt; 
#&gt; Explored 1 nodes (1995 simplex iterations) in 1.93 seconds
#&gt; Thread count was 1 (of 4 available processors)
#&gt; 
#&gt; Solution count 5: 8344.75 8729.64 8732.29 ... 9930.92
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 8.344753088839e+03, best bound 7.555602529974e+03, gap 9.4568%</div><div class='input'><span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='no'>s5</span>, <span class='no'>category_layer</span>)
<span class='no'>s5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/stack'>stack</a></span>(<span class='no'>s5</span>)

<span class='co'># plot solutions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s5</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>p5</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_connectivity_penalties-8.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='https://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com'>Joseph Bennett</a>, <a href='http://www.possinghamlab.org'>Hugh P Possingham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>

